<div class="gantt-scroll" #scrollHost>
  <svg [attr.width]="totalWidth" [attr.height]="totalHeight">

    <!-- Show horizontal line for each row -->
    @for (row of rowLayout; track $index; let r = $index) {
    <ng-container>
      <line x1="0" [attr.y1]="row.y" [attr.x2]="timeWidth" [attr.y2]="row.y" stroke="#d2d4d8" stroke-width="0.9" />
      <line x1="0" [attr.y1]="row.y + rowHeight" [attr.x2]="timeWidth" [attr.y2]="row.y + rowHeight" stroke="#d2d4d8"
        stroke-width="0.9" />
    </ng-container>
    }

    <!-- Show day wise vertical line -->
    @for (g of gridLineDays; track $index) {
    <ng-container>
      <line [attr.x1]="g.x" y1="0" [attr.x2]="g.x" [attr.y2]="totalHeight" stroke="#262626" stroke-width="1" />
      <text [attr.x]="g.x + 4" y="16" font-size="14" fill="#262626">{{ g.label }}</text>
    </ng-container>
    }

    <!-- Show hourly vertical line -->
    @if (showGridLineHours) {
    @for (h of gridLineHours; track $index) {
    <ng-container>
      <line [attr.x1]="h.x" y1="0" [attr.x2]="h.x" [attr.y2]="totalHeight" stroke="#d6d6d6" stroke-width="0.5" />
      @if (pxPerHour >= 8) { <text [attr.x]="h.x + 2" y="28" font-size="10" fill="#000">{{ h.label }}</text> }
    </ng-container>
    }
    }


    @if (todayX) {
    <line [attr.x1]="todayX" y1="0" [attr.x2]="todayX" [attr.y2]="totalHeight" stroke="#ef4444" stroke-width="1.5"
      stroke-dasharray="4 3" />
    }

    @for (t of taskLayout; track $index) {
    <ng-container>
      <rect class="batch-rect" [attr.x]="t.x" [attr.y]="t.y + 6" [attr.width]="t.w" [attr.height]="rowHeight - 12"
        [attr.fill]="t.backgroundColor || '#93c5fd'"></rect>
      <text class="task-label" [attr.fill]="t.textColor" [attr.x]="t.x + 10" [attr.y]="t.y + rowHeight/2 + 4">{{
        t.label }}</text>

      <!-- Edit Icon -->
      <svg (click)="onEditTask(t)" [attr.x]="t.x + t.w - 38" [attr.y]="t.y + (rowHeight/2 - 6)" width="16" height="16"
        viewBox="0 0 18 18" [attr.fill]="t.textColor" style="cursor:pointer;">
        <path d="M12.146.146a.5.5 0 0 1 .708 0l3
        3a.5.5 0 0 1 0 .708l-10
        10L3 14l.146-2.854 10-10zM11.207
        2L4 9.207V11h1.793L13 3.793 11.207
        2z" />
      </svg>

      <!-- Delete Icon -->
      <svg (click)="onDeleteTask(t)" [attr.x]="t.x + t.w - 18" [attr.y]="t.y + (rowHeight/2 - 6)" width="16" height="16"
        viewBox="0 0 18 18" [attr.fill]="t.textColor" style="cursor:pointer;">
        <path d="M5.5 5.5a.5.5 0 0 1
        .5.5v7a.5.5 0 0 1-1
        0v-7a.5.5 0 0 1 .5-.5zM8
        5.5a.5.5 0 0 1
        .5.5v7a.5.5 0 0 1-1
        0v-7a.5.5 0 0 1 .5-.5zM11
        5.5a.5.5 0 0 1 .5.5v7a.5.5
        0 0 1-1 0v-7a.5.5 0 0 1
        .5-.5z" />
        <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1
        1H13v9a2 2 0 0 1-2
        2H5a2 2 0 0 1-2-2V4h-.5a1
        1 0 0 1 0-2H5V1a1 1 0 0
        1 1-1h4a1 1 0 0 1
        1 1v1h2.5a1 1 0 0
        1 1 1zM6 1v1h4V1H6z" />
      </svg>
    </ng-container>
    }

    @for (c of connectors; track $index) {
    <polyline class="connector" [attr.points]="c.points" fill="none" stroke="#6b7280" stroke-width="1.5"
      marker-end="url(#arrowhead)" />
    }
    <defs>
      <marker id="arrowhead" markerWidth="7.5" markerHeight="5.25" refX="6" refY="2.625" orient="auto">
        <polygon points="0 0, 7.5 2.625, 0 5.25" fill="#6b7280"></polygon>
      </marker>
    </defs>
  </svg>

</div>